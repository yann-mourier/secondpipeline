pipeline {
  agent any
  
  stages {
    stage('construction') {
      steps {
        echo "etape de construction"
        sh 'make main'
        sh 'ls'
        archiveArtifacts artifacts: 'main', fingerprint: true
      }
    }
    
    stage('test') {
      steps {
        echo "etape de test"
        sh 'ls'
       /* junit '*.xml' */
      }
    }

    stage('deploiement') {
      steps {
        echo 'etape de deploiement'
      }
      when {
        changelog '.* deploy .*'
      }
    }
  }
}